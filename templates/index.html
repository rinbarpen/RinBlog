{% extends "base.html" %}

{% block title %}Home - RinBlog{% endblock %}

{% block content %}
  {% if latest_daily %}
    <section class="daily-highlight">
      <h2>Daily Highlight</h2>
      <article>
        <h3><a href="{{ url_for('post_detail', slug=latest_daily.slug) }}">{{ latest_daily.title }}</a></h3>
        <p class="meta">{{ latest_daily.display_date }}</p>
        <div class="markdown-body">{{ latest_daily.excerpt | safe }}</div>
        <a class="read-more" href="{{ url_for('daily_posts') }}">Read all daily posts →</a>
      </article>
    </section>
  {% endif %}

  <section class="post-list">
    <div class="section-heading">
      <h2>Latest Posts</h2>
      <p>Thoughts, tutorials, and updates.</p>
    </div>
    {% if posts %}
      <ul class="post-items">
        {% if posts_badges is defined %}
          {% for post, badges in posts_badges %}
            <li>
              {% if post.pinned %}
                <div class="pinned-icon" title="Pinned Post">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="17" x2="12" y2="22"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path></svg>
                </div>
              {% endif %}
              <article>
                <h3><a href="{{ url_for('post_detail', slug=post.slug) }}">{{ post.title }}</a></h3>
                <p class="meta">
                  {{ post.display_date }}
                  {% if post.group_label %}
                    · <a href="{{ url_for('group_posts', group_slug=post.group_slug) }}">{{ post.group_label }}</a>
                  {% endif %}
                </p>
                <p class="summary">{{ post.summary }}</p>
                {% include "partials/tag_badges.html" with context %}
              </article>
            </li>
          {% endfor %}
        {% else %}
          {% for post in posts %}
            {% set badges = [] %}
          <li>
            <article>
              <h3><a href="{{ url_for('post_detail', slug=post.slug) }}">{{ post.title }}</a></h3>
              <p class="meta">
                {{ post.display_date }}
                {% if post.group_label %}
                  · <a href="{{ url_for('group_posts', group_slug=post.group_slug) }}">{{ post.group_label }}</a>
                {% endif %}
              </p>
              <p class="summary">{{ post.summary }}</p>
                {% include "partials/tag_badges.html" with context %}
            </article>
          </li>
          {% endfor %}
        {% endif %}
      </ul>
    {% else %}
      <p>No posts yet. Check back soon!</p>
    {% endif %}
  </section>

  {% if columns %}
    <section class="columns">
      <div class="section-heading">
        <h2>Columns</h2>
      </div>
      <ul class="column-items">
        {% for column in columns %}
          <li>
            <a href="{{ url_for('column_posts', column=column) }}?lang={{ current_lang if current_lang is defined else 'en' }}">
              <span class="column-name">{{ column }}</span>
            </a>
          </li>
        {% endfor %}
      </ul>
    </section>
  {% endif %}

  <section class="groups">
    <div class="section-heading">
      <h2>Browse by Group</h2>
    </div>
    {% if groups %}
      <ul class="group-items">
        {% for group in groups %}
          <li>
            <a href="{{ url_for('group_posts', group_slug=group.slug) }}?lang={{ current_lang if current_lang is defined else 'en' }}">
              <span class="group-name">{{ group.name }}</span>
              <span class="group-count">{{ group.post_count }} posts</span>
            </a>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No groups defined yet.</p>
    {% endif %}
  </section>
{% endblock %}


